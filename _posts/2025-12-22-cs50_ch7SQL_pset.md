---
title: "2025-12-22-cs50_ch7SQL_pset"
date: 2025-12-22
tags:
  - cs
---
**Exercise 2 Movies - Use IMDB's database to complete various SQL queries.**

```SQL
In 13.sql, write a SQL query to list the names of all people who starred in a movie in which Kevin Bacon also starred.

SELECT name
FROM people p
JOIN stars s ON p.id = s.person_id
WHERE s.movie_id IN (
    SELECT s2.movie_id
    FROM stars s2
    JOIN people p2 ON s2.person_id = p2.id
    WHERE p2.name = 'Kevin Bacon'
)
AND p.name != 'Kevin Bacon';
```

```SQL
In 12.sql, write a SQL query to list the titles of all movies in which both Bradley Cooper and Jennifer Lawrence starred

SELECT title
FROM movies m
JOIN stars s1 ON m.id = s1.movie_id
JOIN people p1 ON s1.person_id = p1.id
JOIN stars s2 ON m.id = s2.movie_id
JOIN people p2 ON s2.person_id = p2.id
WHERE p1.name = "Bradley Cooper" AND p2.name = "Jennifer Lawrence";
```

```SQL
In 11.sql, write a SQL query to list the titles of the five highest rated movies (in order)
that Chadwick Boseman starred in, starting with the highest rated.

SELECT title
FROM movies
JOIN ratings ON movies.id = ratings.movie_id
JOIN stars ON movies.id = stars.movie_id
JOIN people ON stars.person_id = people.id
WHERE name = "Chadwick Boseman"
ORDER BY rating DESC
LIMIT 5;
```

```SQL
In 10.sql, write a SQL query to list the names of all people who have directed a movie that received a rating of at least 9.0.

SELECT people.name
FROM people
JOIN directors ON people.id = directors.person_id
JOIN ratings ON directors.movie_id = ratings.movie_id
WHERE ratings.rating >= 9.0;
```

```SQL
In 9.sql, write a SQL query to list the names of all people who starred in a movie released in 2004, ordered by birth year.

SELECT name
FROM people
JOIN movies ON people.id = movies.id
WHERE movies.year = 2004
ORDER BY birth;
```

```SQL
In 8.sql, write a SQL query to list the names of all people who starred in Toy Story.
SELECT name
FROM people
JOIN stars ON people.id = stars.person_id
JOIN movies ON stars.movie_id = movies.id
WHERE movies.title = "Toy Story";
```

```SQL
In 7.sql, write a SQL query to list all movies released in 2010 and their ratings,
in descending order by rating. For movies with the same rating, order them alphabetically by title.
SELECT movies.title, ratings.rating
FROM movies
JOIN ratings ON movies.id = ratings.movie_id
WHERE movies.year = 2010
ORDER BY ratings.rating DESC, movies.title ASC;
```

```SQL
In 6.sql, write a SQL query to determine the average rating of all movies released in 2012

SELECT AVG(rating)
FROM ratings
JOIN movies ON ratings.movie_id = movies.id
WHERE movies.year = 2012;
```

```SQL
In 5.sql, write a SQL query to list the titles and release years of all Harry Potter movies, in chronological order

SELECT title, year
FROM movies
WHERE title LIKE 'Harry Potter%'
ORDER BY year;
```

```SQL
In 4.sql, write a SQL query to determine the number of movies with an IMDb rating of 10.0

SELECT COUNT(*)
FROM ratings
WHERE rating >= 10;
```

```SQL
In 3.sql, write a SQL query to list the titles of all movies with a release date on or after 2018, in alphabetical order.

SELECT title
FROM movies
WHERE year >= 2018
ORDER BY year;
```

```SQL
In 2.sql, write a SQL query to determine the birth year of Emma Stone.

SELECT birth
FROM people
WHERE name = "Emma Stone";
```


```SQL
In 1.sql, write a SQL query to list the titles of all movies released in 2008.

SELECT title
FROM movies
WHERE year = 2008;
```


**Exercise 1 Songs - SQL queries on the top 100 songs and associated data from Spotify. In 8.sql, list names of songs that feature other artists (songs with "feat." in the name). In 7.sql, return the average energy of songs by Drake. 
In 6.sql, list names of songs by Post Malone. In 5.sql, return the average energy of all songs. In 4.sql, list names of songs with danceability, energy, and valence > 0.75.
In 3.sql, list names of the top 5 longest songs, in descending order of length. In 2.sql, list names of all songs in increasing order of tempo. In 1.sql, list names of all songs in the database.**

```SQL
SELECT name
FROM songs
WHERE name LIKE '%feat%';
```

```SQL
SELECT AVG(energy)
FROM songs
WHERE artist_id =
(SELECT id
FROM artists
WHERE name = "Drake"
);
```

```SQL
SELECT name
FROM songs
WHERE artist_id =
(SELECT id
FROM artists
WHERE name = 'Post Malone'
);
```

```SQL
SELECT AVG(energy)
FROM songs;
```

```SQL
SELECT name
FROM songs
WHERE danceability > 0.75
AND energy > 0.75
AND valence > 0.75;
```

```SQL
SELECT name, duration_ms
FROM songs
ORDER BY duration_ms DESC
LIMIT 5;
```

```SQL
SELECT name
FROM songs
ORDER BY TEMPO;
```

```SQL
SELECT name
FROM songs;
```
